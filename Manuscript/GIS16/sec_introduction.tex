\section{Introduction}

%TO-DO lists:
%\begin{itemize}
%	\item Problem definition: define driver profile, rider profile and our price model.
%	
%	\item Define our objective functions (i.e., maximize extra profit), and differentiate it with other optimization goal (e.g., minimize extra distance). 
%	%Given a rider and a driver with their profiles, calculate the cost of accepting the rider. 
%	
%	\item Introduce overall framework, and describe our auction-based mechanism.
%	
%	\item Properties of our framework in both local setting and global setting. In the local setting, show that we will get the same profit as the centralized setting. In the global setting, show that our technique can achieve certain approximation ratio compared with the global optimal (or upper bound of global optimal),  or vice verse we will suffer from certain degenerated cases.
%	
%	\item Optimizations: a) Maintain coarse-grained hierarchic index (adaptive grids, quad-tree), b) maintain novel shortest path index which is fine tuned for ride-sharing applications c) batch processing rider requests (single round bidding v.s. multi-round bidding).
%	
%\end{itemize}

%%%%%% 1. background information
% Ridesharing becomes popular recently because it has potential to match riders with similar itineraries and time schedules, and to bring significant benefits to individual users and the city as a whole. 

Real-time ride-sharing is an important problem because it can ease traffic congestion, decrease auto emissions, while at the same time serve the transportation needs. With the emergence of many commercial platforms (e.g., Uber and Lyft) which automatically match drivers and riders on-the-fly, real-time ride-sharing becomes more and more popular. According to~\cite{uberpool}, millions of trips have been taken on UberPool since its launch at August 2014, and thousands take it five times a week during commuting hours. Enabled by the development and technology advances of smart phones, location-based service and high-speed wireless network, these platforms are typically operated as follows: (1) Riders and drivers with the installed mobile app can join and leave the platform independently, (2) a rider's request, which consists of the origin and destination points, can be submitted at anytime to the platform. (3) Once a new request is received, the platform determines the most appropriate drivers (even en-route) to pick up the rider and complete the request. (4) When the trip is completed, the platform calculates the riders' fare and the drivers' income. With these platforms, riders can share a vehicle with reduced trip cost while enjoying fast and convenient transportation.

%%%%%% 2. explain the challengs and the detour of ridesharing......
Many challenges exist to enable such real-time ride-sharing platforms. From a business point of view, the platform provider (e.g., Uber) wants to maximize it own revenue. However, higher profits should not be gained by either charging passengers more or paying drivers less than what will make it monetarily incentive for both parties to participate in the system. Consequently, the design of a fair pricing model becomes essential in such ride-sharing frameworks. Even though ride-sharing reduces the riders' cost by sharing similar itineraries, it also incurs extra traveled distance for users (i.e., detour). Intuitively, a rider's fare should be reduced based on the amount of detour incurred to their trip. On the other hand, a driver should also be rewarded if his total traveled distance is increased due to such detours. Furthermore, different users (i.e., riders and drivers) might value their time differently. Therefore, a fair pricing model should provided the means to both riders and drivers to express, for a certain amount of detour, how much they expect as compensation and reward, respectively. Finally, in addition to computing fares and incomes for riders and drivers, the model should account for the provider's revenue as well.

The second challenge of a ride-sharing platform is to process new requests in real-time. This requires both matching the request with a driver and scheduling the request for the driver at the same time. If a driver cannot fit a new request in his schedule, the request cannot be assigned to him. Processing the schedule of potentially thousands of drivers to check if they can fit a new request, is computationally expensive. To be scalable, a ride-sharing framework should be able to process hundreds of requests in the presence of potentially thousands of drivers in real-time. Therefore, the design of an efficient framework that assigns riders to drivers, with a fair pricing model that provides incentives for all participants while maximizing the provider's revenue, becomes a distinguishing business strategy.

%First, the framework should consider the conflicting interests of different users (i.e., riders and drivers) and platform providers (e.g., Uber). For example, riders would like to arrive at their destination as quick and cheap as possible, whereas drivers and platform providers would like to maximize their profits. Although ride-sharing can reduce the cost of riders by sharing similar itineraries, it also incurs extra travel distance (i.e., detour). Ideally, riders are expected to be compensated for their detour, while drivers are expected to earn more profit. These factors makes the design of a fair pricing scheme (i.e., the fares and incomes) that satisfies the requirements of both riders and drivers even more complex. Secondly, because the riders requests are generated on-the-fly, the framework should decide the matching drivers (even en-route) at a short amount of time. Therefore, the design of an efficient framework that match riders and drivers, with a fair pricing scheme that provides incentives for all participants becomes a distinguishing business strategy. 

%%% 3. show the shortcomings of existing work and how they fail to address the challenge
The majority of previous studies~\cite{Ota15, Cici15, Cao15, PelzerITS15} focus on improving the efficiency of on-the-fly assignment with the objective of minimizing the total traveled distance of drivers. In these studies a new request is assigned to a driver who can fit the request in his schedule with the least amount of increase in his traveled distance. However, minimizing drivers' total traveled distance is not always equivalent to overall shorter trips for riders. Consequently, when assigning a new request, the driver with minimum increase in total traveled distance is not always the most cost effective one. Few recent studies~\cite{Ma13,Ma15} consider a pricing model by defining monetary incentives for riders and drivers. In \cite{Ma13}, a pricing model is introduced where instead of being compensated, a rider can potentially end up being penalized for longer detours by paying a higher fare. Ma et. al.~\cite{Ma15}, overcome the unfairness issue in \cite{Ma13} to some extent. Even though, a new rider can incur detour in his trip, their model only compensates riders that are already on board. Also, since this model is targeted for a different application, the notion of revenue is left out and it does not provide any incentive for the platform provider. Therefore, there is no established dynamic ride-sharing platform that offers efficient matching, while handling individual preferences and requirements. Furthermore, in all previous studies~\cite{Ma13,Huang14,Ma15}, a centralized server is responsible for matching new request to drivers and scheduling it for them. Most of these studies utilize a spatiotemporal index to narrow down the number of potential drivers that might be able to service the request. With thousands of drivers in the system, even after applying the spatial index, the centralized server needs to perform scheduling for a large number of drivers which can be time consuming. Consequently, with large number of drivers, these frameworks fail to process new requests in real-time.

%in In \cite{Ma13}, a pricing model is introduced where instead of being compensated, a rider can potentially end up being penalized for longer detours by paying a higher fare. 

%In a recent study \cite{Ma15}, the pricing model overcomes the unfairness issue in \cite{Ma13} to some extent. Since riders can value their time differently, It also allows riders to accept/reject ride-sharing requests based on the amount they will be compensated for the incurred detour. However, drivers can similarly value their time different from each other. The pricing model in \cite{Ma15} does not provide any means for drivers to specify their monetary expectations for participating in the system. Furthermore, since this model only tends to divide the cost of the ride among riders, the notion of revenue is left out and it does not provide any incentive for the platform provider.


%%% 4. explain our pricing model, and provide more intuition of better service quality.
To address these challenges, in this paper, we introduce an Auction-based Price-Aware Real-time (\textit{APART}) ride-sharing framework. We propose a general and flexible pricing model that allows both riders and drivers to set their monetary expectations for participating in ride-sharing (formulated as their profiles). Specifically, each rider's profile defines the expected discount ratio for the detours incurred by ride-sharing; each driver profile defines the expected cost in terms of his total traveled distance and time. The model also accounts for the revenue of the platform provider. Consequently, our objective is to maximize the total profit of the ride-sharing framework while satisfying various spatiotemporal and monetary constraints of all users. APART is price-aware which means a new request is assigned to a driver which generates the highest profit. Since our pricing model is designed to compensate riders for detours, the most profitable choice is the one where \textit{riders} incur the least amount of detour. Furthermore, in order to maximize revenue, APART has to service as much requests as possible. As a result, APART engages available drivers more effectively to serve more request (i.e. higher service rate and more income for drivers) with less traveling distance for riders (i.e., higher service quality), thus increasing the revenue of the ride-sharing platforms.

% With our price scheme, our objective is to maximize the total profit of the ridesharing platform, while satisfying the constraints of both riders and drivers.

% Because our pricing model compensates riders for longer trips, in order to maximize the profit, our framework reduces the detour of passengers and hence, providing better service quality. 

%We define a fair price model, which is flexible and general. The profiles are served to xxx. The constraints of are expressed as profiles. Given a user and rider profile, the fare and cost of xxx can be automatically derived from their profiles and other constrains. 

%%% 5. explain our framework
To efficiently assign riders to the candidate drivers, we further introduce a distributed auction-based algorithm. With APART, the server broadcasts a new request to a set of candidate drivers by maintaining an index structure (e.g., grid index). Each candidate driver\footnote{Hereafter we use the term \qoutes{driver} to refer to both the human driver and the software running on his mobile device.} submits a bid (i.e., the profit for accepting this request) based on its current schedule, both his and other riders' profiles, their itineraries and other spatiotemporal constraints. Subsequently, the server collects all the bids from candidate drivers, determines the highest bidder and assigns the rider to that driver. To guarantee high service quality, each driver runs a branch-and-bound algorithm, which performs an exhaustive search to find out whether it can fit a new request into its current scheduling. Each driver maintains a small number of riders and the scheduling process is computed in parallel. Consequently, APART is able to find the most profitable drivers in real-time. With APART, the server does not need to know the exact location of every driver as it is not responsible for performing the scheduling phase. The grid index structure in APART, only needs to store which grid cell a driver is located in. Therefore, compared to a spatial index structure where the exact location of every driver is stored, APART's grid index requires fewer updates and less maintenance, which further reduces the load on the server.

%%% 6. show some experiment resutls
We conduct extensive experiments on a large scale New York City taxi dataset and showed that APART is scalable and efficient, capable of processing hundreds of tasks per second in the presence of thousands of drivers. By comparing our framework with state-of-the-art approaches~\cite{Huang14}, we show that our framework can simultaneously match up to 25\% more riders to drivers (i.e. higher service rate), while the total travel distance of riders are xxx\% less (i.e., better service quality). Finally, because of higher service rate and shorter trips, our framework can earn more profit than other approaches.

The remaining of our paper are organizes as follows:

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% from mohammod 

% Because platforms like Uber and Lyft are becoming more popular (we can show some numbers how their businesses are growing in the recent years). Ridesharing become popular recently. Existing ridesharing studies mainly focus on matching riders and drivers only considering their spatiotemporal constraints (max wait time, maximum detour, etc.)

% It is important to design systems that not only satisfy spatiotemporal constraints of the users, but also take into consideration the monetary aspect of the business (i.e., the fees riders pay, the drivers' income and the system's profit). A key component of such framework is to xxx and xxx.

% While most studies ignore this aspect of the system, T-Share provides a pricing model where on average riders end up paying less when compared to each passenger riding alone. However, based on some experimental results on NYC's taxi dataset, we noticed based on this pricing model, up to x\% of passengers end up paying even more that what they would have payed if they did not share a ride. Hence, this requires the design of a pricing model which is fair to every passenger meaning that if a passenger's trip gets longer as a result of sharing a ride, they should end up paying less (receiving a discount).

% To address the above challenges, in this paper we propose xxx. The goal of our framework is to maximize the profit of the platform. Because we utilize a pricing model which compensates riders for longer trips, in order to maximize the profit, our framework reduces the detour of passengers and hence, providing better service quality.

% Also, APART utilized an auction based approach allowing it to scale by distributing the computation among drivers (You can probably use a good chunk of this part from my CIKM submission).

% We evaluated our .

% The paper is organized as follows:
